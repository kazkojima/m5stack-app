/* A simple LUT sincosf.  */

#define NW 1024
#define PI 3.141592653589793f

/* The table is generated with a python3 snipet:
import math

nw = 1024
delta = math.pi/2/nw
stable = [math.sin(i*delta) for i in range(0,nw)]
print("static float stable[NW] = {")
for i in range(0,nw):
    print(" ", '{:#.8f}'.format(stable[i]), end=',')
    if ((i+1)%4 == 0):
        print()

print("};")
*/

static const float stable[NW] = {
  0.00000000e+00,  1.53398019e-03,  3.06795676e-03,  4.60192612e-03,
  6.13588465e-03,  7.66982874e-03,  9.20375478e-03,  1.07376592e-02,
  1.22715383e-02,  1.38053885e-02,  1.53392063e-02,  1.68729879e-02,
  1.84067299e-02,  1.99404286e-02,  2.14740803e-02,  2.30076815e-02,
  2.45412285e-02,  2.60747178e-02,  2.76081458e-02,  2.91415088e-02,
  3.06748032e-02,  3.22080254e-02,  3.37411719e-02,  3.52742389e-02,
  3.68072229e-02,  3.83401204e-02,  3.98729276e-02,  4.14056410e-02,
  4.29382569e-02,  4.44707719e-02,  4.60031821e-02,  4.75354842e-02,
  4.90676743e-02,  5.05997490e-02,  5.21317047e-02,  5.36635377e-02,
  5.51952443e-02,  5.67268212e-02,  5.82582645e-02,  5.97895707e-02,
  6.13207363e-02,  6.28517576e-02,  6.43826309e-02,  6.59133528e-02,
  6.74439196e-02,  6.89743276e-02,  7.05045734e-02,  7.20346532e-02,
  7.35645636e-02,  7.50943008e-02,  7.66238614e-02,  7.81532416e-02,
  7.96824380e-02,  8.12114468e-02,  8.27402645e-02,  8.42688876e-02,
  8.57973123e-02,  8.73255352e-02,  8.88535526e-02,  9.03813609e-02,
  9.19089565e-02,  9.34363358e-02,  9.49634953e-02,  9.64904314e-02,
  9.80171403e-02,  9.95436187e-02,  1.01069863e-01,  1.02595869e-01,
  1.04121634e-01,  1.05647154e-01,  1.07172425e-01,  1.08697444e-01,
  1.10222207e-01,  1.11746711e-01,  1.13270952e-01,  1.14794927e-01,
  1.16318631e-01,  1.17842062e-01,  1.19365215e-01,  1.20888087e-01,
  1.22410675e-01,  1.23932975e-01,  1.25454983e-01,  1.26976696e-01,
  1.28498111e-01,  1.30019223e-01,  1.31540029e-01,  1.33060525e-01,
  1.34580709e-01,  1.36100575e-01,  1.37620122e-01,  1.39139344e-01,
  1.40658239e-01,  1.42176804e-01,  1.43695033e-01,  1.45212925e-01,
  1.46730474e-01,  1.48247679e-01,  1.49764535e-01,  1.51281038e-01,
  1.52797185e-01,  1.54312973e-01,  1.55828398e-01,  1.57343456e-01,
  1.58858143e-01,  1.60372457e-01,  1.61886394e-01,  1.63399949e-01,
  1.64913120e-01,  1.66425904e-01,  1.67938295e-01,  1.69450291e-01,
  1.70961889e-01,  1.72473084e-01,  1.73983873e-01,  1.75494253e-01,
  1.77004220e-01,  1.78513771e-01,  1.80022901e-01,  1.81531608e-01,
  1.83039888e-01,  1.84547737e-01,  1.86055152e-01,  1.87562129e-01,
  1.89068664e-01,  1.90574755e-01,  1.92080397e-01,  1.93585587e-01,
  1.95090322e-01,  1.96594598e-01,  1.98098411e-01,  1.99601758e-01,
  2.01104635e-01,  2.02607039e-01,  2.04108966e-01,  2.05610413e-01,
  2.07111376e-01,  2.08611852e-01,  2.10111837e-01,  2.11611327e-01,
  2.13110320e-01,  2.14608811e-01,  2.16106797e-01,  2.17604275e-01,
  2.19101240e-01,  2.20597690e-01,  2.22093621e-01,  2.23589029e-01,
  2.25083911e-01,  2.26578264e-01,  2.28072083e-01,  2.29565366e-01,
  2.31058108e-01,  2.32550307e-01,  2.34041959e-01,  2.35533059e-01,
  2.37023606e-01,  2.38513595e-01,  2.40003022e-01,  2.41491885e-01,
  2.42980180e-01,  2.44467903e-01,  2.45955050e-01,  2.47441619e-01,
  2.48927606e-01,  2.50413007e-01,  2.51897818e-01,  2.53382037e-01,
  2.54865660e-01,  2.56348682e-01,  2.57831102e-01,  2.59312915e-01,
  2.60794118e-01,  2.62274707e-01,  2.63754679e-01,  2.65234030e-01,
  2.66712757e-01,  2.68190857e-01,  2.69668326e-01,  2.71145160e-01,
  2.72621355e-01,  2.74096910e-01,  2.75571819e-01,  2.77046080e-01,
  2.78519689e-01,  2.79992643e-01,  2.81464938e-01,  2.82936570e-01,
  2.84407537e-01,  2.85877835e-01,  2.87347460e-01,  2.88816408e-01,
  2.90284677e-01,  2.91752263e-01,  2.93219163e-01,  2.94685372e-01,
  2.96150888e-01,  2.97615707e-01,  2.99079826e-01,  3.00543241e-01,
  3.02005949e-01,  3.03467947e-01,  3.04929230e-01,  3.06389795e-01,
  3.07849640e-01,  3.09308760e-01,  3.10767153e-01,  3.12224814e-01,
  3.13681740e-01,  3.15137929e-01,  3.16593376e-01,  3.18048077e-01,
  3.19502031e-01,  3.20955232e-01,  3.22407679e-01,  3.23859367e-01,
  3.25310292e-01,  3.26760452e-01,  3.28209844e-01,  3.29658463e-01,
  3.31106306e-01,  3.32553370e-01,  3.33999651e-01,  3.35445147e-01,
  3.36889853e-01,  3.38333767e-01,  3.39776884e-01,  3.41219202e-01,
  3.42660717e-01,  3.44101426e-01,  3.45541325e-01,  3.46980411e-01,
  3.48418680e-01,  3.49856130e-01,  3.51292756e-01,  3.52728556e-01,
  3.54163525e-01,  3.55597662e-01,  3.57030961e-01,  3.58463421e-01,
  3.59895037e-01,  3.61325806e-01,  3.62755724e-01,  3.64184790e-01,
  3.65612998e-01,  3.67040346e-01,  3.68466830e-01,  3.69892447e-01,
  3.71317194e-01,  3.72741067e-01,  3.74164063e-01,  3.75586178e-01,
  3.77007410e-01,  3.78427755e-01,  3.79847209e-01,  3.81265769e-01,
  3.82683432e-01,  3.84100195e-01,  3.85516054e-01,  3.86931006e-01,
  3.88345047e-01,  3.89758174e-01,  3.91170384e-01,  3.92581674e-01,
  3.93992040e-01,  3.95401479e-01,  3.96809987e-01,  3.98217562e-01,
  3.99624200e-01,  4.01029897e-01,  4.02434651e-01,  4.03838458e-01,
  4.05241314e-01,  4.06643217e-01,  4.08044163e-01,  4.09444149e-01,
  4.10843171e-01,  4.12241227e-01,  4.13638312e-01,  4.15034424e-01,
  4.16429560e-01,  4.17823716e-01,  4.19216888e-01,  4.20609074e-01,
  4.22000271e-01,  4.23390474e-01,  4.24779681e-01,  4.26167889e-01,
  4.27555093e-01,  4.28941292e-01,  4.30326481e-01,  4.31710658e-01,
  4.33093819e-01,  4.34475961e-01,  4.35857080e-01,  4.37237174e-01,
  4.38616239e-01,  4.39994271e-01,  4.41371269e-01,  4.42747228e-01,
  4.44122145e-01,  4.45496017e-01,  4.46868840e-01,  4.48240612e-01,
  4.49611330e-01,  4.50980989e-01,  4.52349587e-01,  4.53717121e-01,
  4.55083587e-01,  4.56448982e-01,  4.57813304e-01,  4.59176548e-01,
  4.60538711e-01,  4.61899791e-01,  4.63259784e-01,  4.64618686e-01,
  4.65976496e-01,  4.67333209e-01,  4.68688822e-01,  4.70043332e-01,
  4.71396737e-01,  4.72749032e-01,  4.74100215e-01,  4.75450282e-01,
  4.76799230e-01,  4.78147056e-01,  4.79493758e-01,  4.80839331e-01,
  4.82183772e-01,  4.83527079e-01,  4.84869248e-01,  4.86210276e-01,
  4.87550160e-01,  4.88888897e-01,  4.90226483e-01,  4.91562916e-01,
  4.92898192e-01,  4.94232309e-01,  4.95565262e-01,  4.96897049e-01,
  4.98227667e-01,  4.99557113e-01,  5.00885383e-01,  5.02212474e-01,
  5.03538384e-01,  5.04863109e-01,  5.06186645e-01,  5.07508991e-01,
  5.08830143e-01,  5.10150097e-01,  5.11468850e-01,  5.12786401e-01,
  5.14102744e-01,  5.15417878e-01,  5.16731799e-01,  5.18044504e-01,
  5.19355990e-01,  5.20666254e-01,  5.21975293e-01,  5.23283103e-01,
  5.24589683e-01,  5.25895027e-01,  5.27199135e-01,  5.28502002e-01,
  5.29803625e-01,  5.31104001e-01,  5.32403128e-01,  5.33701002e-01,
  5.34997620e-01,  5.36292979e-01,  5.37587076e-01,  5.38879909e-01,
  5.40171473e-01,  5.41461766e-01,  5.42750785e-01,  5.44038527e-01,
  5.45324988e-01,  5.46610167e-01,  5.47894059e-01,  5.49176662e-01,
  5.50457973e-01,  5.51737988e-01,  5.53016706e-01,  5.54294121e-01,
  5.55570233e-01,  5.56845037e-01,  5.58118531e-01,  5.59390712e-01,
  5.60661576e-01,  5.61931121e-01,  5.63199344e-01,  5.64466242e-01,
  5.65731811e-01,  5.66996049e-01,  5.68258953e-01,  5.69520519e-01,
  5.70780746e-01,  5.72039629e-01,  5.73297167e-01,  5.74553355e-01,
  5.75808191e-01,  5.77061673e-01,  5.78313796e-01,  5.79564559e-01,
  5.80813958e-01,  5.82061990e-01,  5.83308653e-01,  5.84553943e-01,
  5.85797857e-01,  5.87040394e-01,  5.88281548e-01,  5.89521319e-01,
  5.90759702e-01,  5.91996695e-01,  5.93232295e-01,  5.94466499e-01,
  5.95699304e-01,  5.96930708e-01,  5.98160707e-01,  5.99389298e-01,
  6.00616479e-01,  6.01842247e-01,  6.03066599e-01,  6.04289531e-01,
  6.05511041e-01,  6.06731127e-01,  6.07949785e-01,  6.09167012e-01,
  6.10382806e-01,  6.11597164e-01,  6.12810082e-01,  6.14021559e-01,
  6.15231591e-01,  6.16440175e-01,  6.17647308e-01,  6.18852988e-01,
  6.20057212e-01,  6.21259977e-01,  6.22461279e-01,  6.23661118e-01,
  6.24859488e-01,  6.26056388e-01,  6.27251815e-01,  6.28445767e-01,
  6.29638239e-01,  6.30829230e-01,  6.32018736e-01,  6.33206755e-01,
  6.34393284e-01,  6.35578320e-01,  6.36761861e-01,  6.37943904e-01,
  6.39124445e-01,  6.40303482e-01,  6.41481013e-01,  6.42657034e-01,
  6.43831543e-01,  6.45004537e-01,  6.46176013e-01,  6.47345969e-01,
  6.48514401e-01,  6.49681307e-01,  6.50846685e-01,  6.52010531e-01,
  6.53172843e-01,  6.54333618e-01,  6.55492853e-01,  6.56650546e-01,
  6.57806693e-01,  6.58961293e-01,  6.60114342e-01,  6.61265838e-01,
  6.62415778e-01,  6.63564159e-01,  6.64710978e-01,  6.65856234e-01,
  6.66999922e-01,  6.68142041e-01,  6.69282588e-01,  6.70421560e-01,
  6.71558955e-01,  6.72694769e-01,  6.73829000e-01,  6.74961646e-01,
  6.76092704e-01,  6.77222170e-01,  6.78350043e-01,  6.79476320e-01,
  6.80600998e-01,  6.81724074e-01,  6.82845546e-01,  6.83965412e-01,
  6.85083668e-01,  6.86200312e-01,  6.87315341e-01,  6.88428753e-01,
  6.89540545e-01,  6.90650714e-01,  6.91759258e-01,  6.92866175e-01,
  6.93971461e-01,  6.95075114e-01,  6.96177131e-01,  6.97277511e-01,
  6.98376249e-01,  6.99473345e-01,  7.00568794e-01,  7.01662595e-01,
  7.02754744e-01,  7.03845241e-01,  7.04934080e-01,  7.06021261e-01,
  7.07106781e-01,  7.08190637e-01,  7.09272826e-01,  7.10353347e-01,
  7.11432196e-01,  7.12509371e-01,  7.13584869e-01,  7.14658688e-01,
  7.15730825e-01,  7.16801279e-01,  7.17870045e-01,  7.18937122e-01,
  7.20002508e-01,  7.21066199e-01,  7.22128194e-01,  7.23188489e-01,
  7.24247083e-01,  7.25303972e-01,  7.26359155e-01,  7.27412629e-01,
  7.28464390e-01,  7.29514438e-01,  7.30562769e-01,  7.31609381e-01,
  7.32654272e-01,  7.33697438e-01,  7.34738878e-01,  7.35778589e-01,
  7.36816569e-01,  7.37852815e-01,  7.38887324e-01,  7.39920095e-01,
  7.40951125e-01,  7.41980412e-01,  7.43007952e-01,  7.44033744e-01,
  7.45057785e-01,  7.46080074e-01,  7.47100606e-01,  7.48119380e-01,
  7.49136395e-01,  7.50151646e-01,  7.51165132e-01,  7.52176850e-01,
  7.53186799e-01,  7.54194975e-01,  7.55201377e-01,  7.56206001e-01,
  7.57208847e-01,  7.58209910e-01,  7.59209189e-01,  7.60206682e-01,
  7.61202385e-01,  7.62196298e-01,  7.63188417e-01,  7.64178741e-01,
  7.65167266e-01,  7.66153990e-01,  7.67138912e-01,  7.68122029e-01,
  7.69103338e-01,  7.70082837e-01,  7.71060524e-01,  7.72036397e-01,
  7.73010453e-01,  7.73982691e-01,  7.74953107e-01,  7.75921699e-01,
  7.76888466e-01,  7.77853404e-01,  7.78816512e-01,  7.79777788e-01,
  7.80737229e-01,  7.81694832e-01,  7.82650596e-01,  7.83604519e-01,
  7.84556597e-01,  7.85506830e-01,  7.86455214e-01,  7.87401747e-01,
  7.88346428e-01,  7.89289253e-01,  7.90230221e-01,  7.91169330e-01,
  7.92106577e-01,  7.93041960e-01,  7.93975478e-01,  7.94907126e-01,
  7.95836905e-01,  7.96764810e-01,  7.97690841e-01,  7.98614995e-01,
  7.99537269e-01,  8.00457662e-01,  8.01376172e-01,  8.02292796e-01,
  8.03207531e-01,  8.04120377e-01,  8.05031331e-01,  8.05940391e-01,
  8.06847554e-01,  8.07752818e-01,  8.08656182e-01,  8.09557642e-01,
  8.10457198e-01,  8.11354847e-01,  8.12250587e-01,  8.13144415e-01,
  8.14036330e-01,  8.14926329e-01,  8.15814411e-01,  8.16700573e-01,
  8.17584813e-01,  8.18467130e-01,  8.19347520e-01,  8.20225983e-01,
  8.21102515e-01,  8.21977115e-01,  8.22849781e-01,  8.23720511e-01,
  8.24589303e-01,  8.25456154e-01,  8.26321063e-01,  8.27184027e-01,
  8.28045045e-01,  8.28904115e-01,  8.29761234e-01,  8.30616400e-01,
  8.31469612e-01,  8.32320868e-01,  8.33170165e-01,  8.34017501e-01,
  8.34862875e-01,  8.35706284e-01,  8.36547727e-01,  8.37387202e-01,
  8.38224706e-01,  8.39060237e-01,  8.39893794e-01,  8.40725375e-01,
  8.41554977e-01,  8.42382600e-01,  8.43208240e-01,  8.44031895e-01,
  8.44853565e-01,  8.45673247e-01,  8.46490939e-01,  8.47306639e-01,
  8.48120345e-01,  8.48932055e-01,  8.49741768e-01,  8.50549481e-01,
  8.51355193e-01,  8.52158902e-01,  8.52960605e-01,  8.53760301e-01,
  8.54557988e-01,  8.55353665e-01,  8.56147328e-01,  8.56938977e-01,
  8.57728610e-01,  8.58516224e-01,  8.59301818e-01,  8.60085390e-01,
  8.60866939e-01,  8.61646461e-01,  8.62423956e-01,  8.63199422e-01,
  8.63972856e-01,  8.64744258e-01,  8.65513624e-01,  8.66280954e-01,
  8.67046246e-01,  8.67809497e-01,  8.68570706e-01,  8.69329871e-01,
  8.70086991e-01,  8.70842063e-01,  8.71595087e-01,  8.72346059e-01,
  8.73094978e-01,  8.73841843e-01,  8.74586652e-01,  8.75329403e-01,
  8.76070094e-01,  8.76808724e-01,  8.77545290e-01,  8.78279792e-01,
  8.79012226e-01,  8.79742593e-01,  8.80470889e-01,  8.81197113e-01,
  8.81921264e-01,  8.82643340e-01,  8.83363339e-01,  8.84081259e-01,
  8.84797098e-01,  8.85510856e-01,  8.86222530e-01,  8.86932119e-01,
  8.87639620e-01,  8.88345033e-01,  8.89048356e-01,  8.89749586e-01,
  8.90448723e-01,  8.91145765e-01,  8.91840709e-01,  8.92533555e-01,
  8.93224301e-01,  8.93912945e-01,  8.94599486e-01,  8.95283921e-01,
  8.95966250e-01,  8.96646470e-01,  8.97324581e-01,  8.98000580e-01,
  8.98674466e-01,  8.99346237e-01,  9.00015892e-01,  9.00683429e-01,
  9.01348847e-01,  9.02012144e-01,  9.02673318e-01,  9.03332368e-01,
  9.03989293e-01,  9.04644091e-01,  9.05296759e-01,  9.05947298e-01,
  9.06595705e-01,  9.07241978e-01,  9.07886116e-01,  9.08528119e-01,
  9.09167983e-01,  9.09805708e-01,  9.10441292e-01,  9.11074734e-01,
  9.11706032e-01,  9.12335185e-01,  9.12962190e-01,  9.13587048e-01,
  9.14209756e-01,  9.14830312e-01,  9.15448716e-01,  9.16064966e-01,
  9.16679060e-01,  9.17290997e-01,  9.17900776e-01,  9.18508394e-01,
  9.19113852e-01,  9.19717146e-01,  9.20318277e-01,  9.20917242e-01,
  9.21514039e-01,  9.22108669e-01,  9.22701128e-01,  9.23291417e-01,
  9.23879533e-01,  9.24465474e-01,  9.25049241e-01,  9.25630831e-01,
  9.26210242e-01,  9.26787474e-01,  9.27362526e-01,  9.27935395e-01,
  9.28506080e-01,  9.29074581e-01,  9.29640896e-01,  9.30205023e-01,
  9.30766961e-01,  9.31326709e-01,  9.31884266e-01,  9.32439629e-01,
  9.32992799e-01,  9.33543773e-01,  9.34092550e-01,  9.34639130e-01,
  9.35183510e-01,  9.35725689e-01,  9.36265667e-01,  9.36803442e-01,
  9.37339012e-01,  9.37872376e-01,  9.38403534e-01,  9.38932484e-01,
  9.39459224e-01,  9.39983753e-01,  9.40506071e-01,  9.41026175e-01,
  9.41544065e-01,  9.42059740e-01,  9.42573198e-01,  9.43084437e-01,
  9.43593458e-01,  9.44100258e-01,  9.44604837e-01,  9.45107193e-01,
  9.45607325e-01,  9.46105232e-01,  9.46600913e-01,  9.47094366e-01,
  9.47585591e-01,  9.48074586e-01,  9.48561350e-01,  9.49045882e-01,
  9.49528181e-01,  9.50008245e-01,  9.50486074e-01,  9.50961666e-01,
  9.51435021e-01,  9.51906137e-01,  9.52375013e-01,  9.52841648e-01,
  9.53306040e-01,  9.53768190e-01,  9.54228095e-01,  9.54685755e-01,
  9.55141168e-01,  9.55594334e-01,  9.56045251e-01,  9.56493919e-01,
  9.56940336e-01,  9.57384501e-01,  9.57826413e-01,  9.58266071e-01,
  9.58703475e-01,  9.59138622e-01,  9.59571513e-01,  9.60002146e-01,
  9.60430519e-01,  9.60856633e-01,  9.61280486e-01,  9.61702077e-01,
  9.62121404e-01,  9.62538468e-01,  9.62953267e-01,  9.63365800e-01,
  9.63776066e-01,  9.64184064e-01,  9.64589793e-01,  9.64993253e-01,
  9.65394442e-01,  9.65793359e-01,  9.66190003e-01,  9.66584374e-01,
  9.66976471e-01,  9.67366292e-01,  9.67753837e-01,  9.68139105e-01,
  9.68522094e-01,  9.68902805e-01,  9.69281235e-01,  9.69657385e-01,
  9.70031253e-01,  9.70402839e-01,  9.70772141e-01,  9.71139158e-01,
  9.71503891e-01,  9.71866337e-01,  9.72226497e-01,  9.72584369e-01,
  9.72939952e-01,  9.73293246e-01,  9.73644250e-01,  9.73992962e-01,
  9.74339383e-01,  9.74683511e-01,  9.75025345e-01,  9.75364885e-01,
  9.75702130e-01,  9.76037079e-01,  9.76369731e-01,  9.76700086e-01,
  9.77028143e-01,  9.77353900e-01,  9.77677358e-01,  9.77998515e-01,
  9.78317371e-01,  9.78633924e-01,  9.78948175e-01,  9.79260123e-01,
  9.79569766e-01,  9.79877104e-01,  9.80182136e-01,  9.80484862e-01,
  9.80785280e-01,  9.81083391e-01,  9.81379193e-01,  9.81672686e-01,
  9.81963869e-01,  9.82252741e-01,  9.82539302e-01,  9.82823551e-01,
  9.83105487e-01,  9.83385110e-01,  9.83662419e-01,  9.83937413e-01,
  9.84210092e-01,  9.84480455e-01,  9.84748502e-01,  9.85014231e-01,
  9.85277642e-01,  9.85538735e-01,  9.85797509e-01,  9.86053963e-01,
  9.86308097e-01,  9.86559910e-01,  9.86809402e-01,  9.87056571e-01,
  9.87301418e-01,  9.87543942e-01,  9.87784142e-01,  9.88022017e-01,
  9.88257568e-01,  9.88490793e-01,  9.88721692e-01,  9.88950265e-01,
  9.89176510e-01,  9.89400428e-01,  9.89622017e-01,  9.89841278e-01,
  9.90058210e-01,  9.90272812e-01,  9.90485084e-01,  9.90695025e-01,
  9.90902635e-01,  9.91107914e-01,  9.91310860e-01,  9.91511473e-01,
  9.91709754e-01,  9.91905700e-01,  9.92099313e-01,  9.92290591e-01,
  9.92479535e-01,  9.92666142e-01,  9.92850414e-01,  9.93032350e-01,
  9.93211949e-01,  9.93389211e-01,  9.93564136e-01,  9.93736722e-01,
  9.93906970e-01,  9.94074879e-01,  9.94240449e-01,  9.94403680e-01,
  9.94564571e-01,  9.94723121e-01,  9.94879331e-01,  9.95033199e-01,
  9.95184727e-01,  9.95333912e-01,  9.95480755e-01,  9.95625256e-01,
  9.95767414e-01,  9.95907229e-01,  9.96044701e-01,  9.96179829e-01,
  9.96312612e-01,  9.96443051e-01,  9.96571146e-01,  9.96696895e-01,
  9.96820299e-01,  9.96941358e-01,  9.97060070e-01,  9.97176437e-01,
  9.97290457e-01,  9.97402130e-01,  9.97511456e-01,  9.97618435e-01,
  9.97723067e-01,  9.97825350e-01,  9.97925286e-01,  9.98022874e-01,
  9.98118113e-01,  9.98211003e-01,  9.98301545e-01,  9.98389737e-01,
  9.98475581e-01,  9.98559074e-01,  9.98640218e-01,  9.98719012e-01,
  9.98795456e-01,  9.98869550e-01,  9.98941293e-01,  9.99010686e-01,
  9.99077728e-01,  9.99142419e-01,  9.99204759e-01,  9.99264747e-01,
  9.99322385e-01,  9.99377670e-01,  9.99430605e-01,  9.99481187e-01,
  9.99529418e-01,  9.99575296e-01,  9.99618822e-01,  9.99659997e-01,
  9.99698819e-01,  9.99735288e-01,  9.99769405e-01,  9.99801170e-01,
  9.99830582e-01,  9.99857641e-01,  9.99882347e-01,  9.99904701e-01,
  9.99924702e-01,  9.99942350e-01,  9.99957645e-01,  9.99970586e-01,
  9.99981175e-01,  9.99989411e-01,  9.99995294e-01,  9.99998823e-01,
};

static float
kernel_lut_sinf (float x)
{
  float co;
  int i = (int) ((x * 2 * NW)/PI);
  float y = x - i * PI /(2 * NW);
  if (i == NW)
    return 1.0;
  if (i == 0)
    co = 1.0;
  else
    co = stable[NW - i];
  return stable[i] * (1 - y*y/2) + co * (y - y*y*y/6);
}

extern "C" float
Sinf (float x)
{
  float r;
  int i;
  int sig = 1;
  if (x < 0)
    {
      sig = -1;
      x = -x;
    }
  i = (int) (x / (2 * PI));
  r = x - i * 2 * PI;
  if (r > PI)
    {
      sig = -sig;
      r -= PI;
    }
  if (r > PI/2)
    r = PI - r;
  return (sig > 0) ? kernel_lut_sinf(r) : -kernel_lut_sinf(r);
}

extern "C" float
Cosf (float x)
{
  return Sinf (x + PI/2);
}

extern "C" void
Sincosf (float x, float *s, float *c)
{
  if (s)
    *s = Sinf (x);
  if (c)
    *c = Cosf (x);
}

#if 0
#include <cstdio>
#include <cmath>

// test sinsoc
int main ()
{
  int i;
  for (i = 0; i < 4096; i++)
    {
      float s, c;
      float x = i*PI/4096/2;
      Sincosf (x, &s, &c);
      printf ("%f %f\n", (double)s - sin(x), (double)c - cos(x));
    }
  return 0;
}
#endif
